---
layout: post
title: "Rails: find(nil)"
---

h1. {{ page.title }}

p(meta). 26 Março 2010 - Niterói/RJ

Em alguns casos, pode ser necessário buscar um objeto pelo id e ter simplesmente um <b>nil</b> caso não exista um objeto com o tal id.<br /><br />Se alguém tentar fazer:<br /><br /><pre class="textmate-source"><span class="source source_ruby source_ruby_rails">debit <span class="keyword keyword_operator keyword_operator_assignment keyword_operator_assignment_ruby">=</span> <span class="support support_class support_class_ruby">Debit</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>find<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">101010</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span></span></pre><br />Verá o erro:<br /><br /><pre class="textmate-source"><span class="text text_plain"><span class="meta meta_paragraph meta_paragraph_text">ActiveRecord::RecordNotFound: Couldn't find Debit with ID=101010<br />       <span class="meta meta_paragraph meta_paragraph_text">from /Library/Ruby/Gems/1.8/gems/activerecord-2.3.5/lib/active_record/base.rb:1586:in `find_one'</span><br />        from /Library/Ruby/Gems/1.8/gems/activerecord-2.3.5/lib/active_record/base.rb:1569:in `find_from_ids'<br />        from /Library/Ruby/Gems/1.8/gems/activerecord-2.3.5/lib/active_record/base.rb:616:in `find'<br />        from (irb):4<br /></span></span></pre><br />Isso porque o método <b>find</b> do <b>Active Record</b> lança um <b>RecordNotFound Exception</b> se não achar o que está procurando. O jeito é:<br /><br /><pre class="textmate-source"><span class="source source_ruby source_ruby_rails"><span class="keyword keyword_control keyword_control_ruby">begin</span><br />  debit <span class="keyword keyword_operator keyword_operator_assignment keyword_operator_assignment_ruby">=</span> <span class="support support_class support_class_ruby">Debit</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>find<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">101010</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span><br /><span class="keyword keyword_control keyword_control_ruby">rescue</span> <span class="variable variable_other variable_other_constant variable_other_constant_ruby">Exception</span> <span class="punctuation punctuation_separator punctuation_separator_key-value">=></span> e<br />  debit <span class="keyword keyword_operator keyword_operator_assignment keyword_operator_assignment_ruby">=</span> <span class="constant constant_language constant_language_ruby">nil</span><br /><span class="keyword keyword_control keyword_control_ruby">end</span><br /></span></pre><br />Mas... se você for uma pessoa sagaz... vai fazer:<br /><br /><pre class="textmate-source"><span class="source source_ruby source_ruby_rails">debit <span class="keyword keyword_operator keyword_operator_assignment keyword_operator_assignment_ruby">=</span> <span class="support support_class support_class_ruby">Debit</span><span class="punctuation punctuation_separator punctuation_separator_method punctuation_separator_method_ruby">.</span>find_by_id<span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">(</span><span class="constant constant_numeric constant_numeric_ruby">101010</span><span class="punctuation punctuation_section punctuation_section_function punctuation_section_function_ruby">)</span></span></pre><br />E terá o seu lindo e esperado objeto ou nil, caso o objeto não for encontrado.<div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/1372066769163881306-217143380904052401?l=rafael.xlii.com.br' alt='' /></div>